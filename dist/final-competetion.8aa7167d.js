function e(e,t,s,a){Object.defineProperty(e,t,{get:s,set:a,enumerable:!0,configurable:!0})}var t=globalThis,s={},a={},n=t.parcelRequiree40a;null==n&&((n=function(e){if(e in s)return s[e].exports;if(e in a){var t=a[e];delete a[e];var n={id:e,exports:{}};return s[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){a[e]=t},t.parcelRequiree40a=n);var r=n.register;r("1b2ls",function(t,s){e(t.exports,"Fragment",()=>a,e=>a=e),e(t.exports,"jsx",()=>r,e=>r=e),e(t.exports,"jsxs",()=>l,e=>l=e);var a,r,l,o=n("acw62"),i=Symbol.for("react.element"),c=Symbol.for("react.fragment"),d=Object.prototype.hasOwnProperty,m=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,s){var a,n={},r=null,l=null;for(a in void 0!==s&&(r=""+s),void 0!==t.key&&(r=""+t.key),void 0!==t.ref&&(l=t.ref),t)d.call(t,a)&&!u.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===n[a]&&(n[a]=t[a]);return{$$typeof:i,type:e,key:r,ref:l,props:n,_owner:m.current}}a=c,r=x,l=x}),r("acw62",function(e,t){e.exports=n("2pUnB")}),r("2pUnB",function(t,s){e(t.exports,"Children",()=>a,e=>a=e),e(t.exports,"Component",()=>n,e=>n=e),e(t.exports,"Fragment",()=>r,e=>r=e),e(t.exports,"Profiler",()=>l,e=>l=e),e(t.exports,"PureComponent",()=>o,e=>o=e),e(t.exports,"StrictMode",()=>i,e=>i=e),e(t.exports,"Suspense",()=>c,e=>c=e),e(t.exports,"__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED",()=>d,e=>d=e),e(t.exports,"act",()=>m,e=>m=e),e(t.exports,"cloneElement",()=>u,e=>u=e),e(t.exports,"createContext",()=>x,e=>x=e),e(t.exports,"createElement",()=>p,e=>p=e),e(t.exports,"createFactory",()=>f,e=>f=e),e(t.exports,"createRef",()=>h,e=>h=e),e(t.exports,"forwardRef",()=>b,e=>b=e),e(t.exports,"isValidElement",()=>g,e=>g=e),e(t.exports,"lazy",()=>y,e=>y=e),e(t.exports,"memo",()=>j,e=>j=e),e(t.exports,"startTransition",()=>w,e=>w=e),e(t.exports,"unstable_act",()=>v,e=>v=e),e(t.exports,"useCallback",()=>N,e=>N=e),e(t.exports,"useContext",()=>k,e=>k=e),e(t.exports,"useDebugValue",()=>C,e=>C=e),e(t.exports,"useDeferredValue",()=>S,e=>S=e),e(t.exports,"useEffect",()=>I,e=>I=e),e(t.exports,"useId",()=>T,e=>T=e),e(t.exports,"useImperativeHandle",()=>z,e=>z=e),e(t.exports,"useInsertionEffect",()=>_,e=>_=e),e(t.exports,"useLayoutEffect",()=>A,e=>A=e),e(t.exports,"useMemo",()=>R,e=>R=e),e(t.exports,"useReducer",()=>E,e=>E=e),e(t.exports,"useRef",()=>P,e=>P=e),e(t.exports,"useState",()=>q,e=>q=e),e(t.exports,"useSyncExternalStore",()=>D,e=>D=e),e(t.exports,"useTransition",()=>M,e=>M=e),e(t.exports,"version",()=>O,e=>O=e);var a,n,r,l,o,i,c,d,m,u,x,p,f,h,b,g,y,j,w,v,N,k,C,S,I,T,z,_,A,R,E,P,q,D,M,O,$=Symbol.for("react.element"),L=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),H=Symbol.for("react.provider"),V=Symbol.for("react.context"),Q=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),G=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),W=Symbol.iterator,X={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Y=Object.assign,Z={};function ee(e,t,s){this.props=e,this.context=t,this.refs=Z,this.updater=s||X}function et(){}function es(e,t,s){this.props=e,this.context=t,this.refs=Z,this.updater=s||X}ee.prototype.isReactComponent={},ee.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},ee.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},et.prototype=ee.prototype;var ea=es.prototype=new et;ea.constructor=es,Y(ea,ee.prototype),ea.isPureReactComponent=!0;var en=Array.isArray,er=Object.prototype.hasOwnProperty,el={current:null},eo={key:!0,ref:!0,__self:!0,__source:!0};function ei(e,t,s){var a,n={},r=null,l=null;if(null!=t)for(a in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(r=""+t.key),t)er.call(t,a)&&!eo.hasOwnProperty(a)&&(n[a]=t[a]);var o=arguments.length-2;if(1===o)n.children=s;else if(1<o){for(var i=Array(o),c=0;c<o;c++)i[c]=arguments[c+2];n.children=i}if(e&&e.defaultProps)for(a in o=e.defaultProps)void 0===n[a]&&(n[a]=o[a]);return{$$typeof:$,type:e,key:r,ref:l,props:n,_owner:el.current}}function ec(e){return"object"==typeof e&&null!==e&&e.$$typeof===$}var ed=/\/+/g;function em(e,t){var s,a;return"object"==typeof e&&null!==e&&null!=e.key?(s=""+e.key,a={"=":"=0",":":"=2"},"$"+s.replace(/[=:]/g,function(e){return a[e]})):t.toString(36)}function eu(e,t,s){if(null==e)return e;var a=[],n=0;return!function e(t,s,a,n,r){var l,o,i,c=typeof t;("undefined"===c||"boolean"===c)&&(t=null);var d=!1;if(null===t)d=!0;else switch(c){case"string":case"number":d=!0;break;case"object":switch(t.$$typeof){case $:case L:d=!0}}if(d)return r=r(d=t),t=""===n?"."+em(d,0):n,en(r)?(a="",null!=t&&(a=t.replace(ed,"$&/")+"/"),e(r,s,a,"",function(e){return e})):null!=r&&(ec(r)&&(l=r,o=a+(!r.key||d&&d.key===r.key?"":(""+r.key).replace(ed,"$&/")+"/")+t,r={$$typeof:$,type:l.type,key:o,ref:l.ref,props:l.props,_owner:l._owner}),s.push(r)),1;if(d=0,n=""===n?".":n+":",en(t))for(var m=0;m<t.length;m++){var u=n+em(c=t[m],m);d+=e(c,s,a,u,r)}else if("function"==typeof(u=null===(i=t)||"object"!=typeof i?null:"function"==typeof(i=W&&i[W]||i["@@iterator"])?i:null))for(t=u.call(t),m=0;!(c=t.next()).done;)u=n+em(c=c.value,m++),d+=e(c,s,a,u,r);else if("object"===c)throw Error("Objects are not valid as a React child (found: "+("[object Object]"===(s=String(t))?"object with keys {"+Object.keys(t).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return d}(e,a,"","",function(e){return t.call(s,e,n++)}),a}function ex(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var ep={current:null},ef={transition:null};function eh(){throw Error("act(...) is not supported in production builds of React.")}a={map:eu,forEach:function(e,t,s){eu(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return eu(e,function(){t++}),t},toArray:function(e){return eu(e,function(e){return e})||[]},only:function(e){if(!ec(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},n=ee,r=F,l=B,o=es,i=U,c=J,d={ReactCurrentDispatcher:ep,ReactCurrentBatchConfig:ef,ReactCurrentOwner:el},m=eh,u=function(e,t,s){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=Y({},e.props),n=e.key,r=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(r=t.ref,l=el.current),void 0!==t.key&&(n=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(i in t)er.call(t,i)&&!eo.hasOwnProperty(i)&&(a[i]=void 0===t[i]&&void 0!==o?o[i]:t[i])}var i=arguments.length-2;if(1===i)a.children=s;else if(1<i){o=Array(i);for(var c=0;c<i;c++)o[c]=arguments[c+2];a.children=o}return{$$typeof:$,type:e.type,key:n,ref:r,props:a,_owner:l}},x=function(e){return(e={$$typeof:V,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:H,_context:e},e.Consumer=e},p=ei,f=function(e){var t=ei.bind(null,e);return t.type=e,t},h=function(){return{current:null}},b=function(e){return{$$typeof:Q,render:e}},g=ec,y=function(e){return{$$typeof:K,_payload:{_status:-1,_result:e},_init:ex}},j=function(e,t){return{$$typeof:G,type:e,compare:void 0===t?null:t}},w=function(e){var t=ef.transition;ef.transition={};try{e()}finally{ef.transition=t}},v=eh,N=function(e,t){return ep.current.useCallback(e,t)},k=function(e){return ep.current.useContext(e)},C=function(){},S=function(e){return ep.current.useDeferredValue(e)},I=function(e,t){return ep.current.useEffect(e,t)},T=function(){return ep.current.useId()},z=function(e,t,s){return ep.current.useImperativeHandle(e,t,s)},_=function(e,t){return ep.current.useInsertionEffect(e,t)},A=function(e,t){return ep.current.useLayoutEffect(e,t)},R=function(e,t){return ep.current.useMemo(e,t)},E=function(e,t,s){return ep.current.useReducer(e,t,s)},P=function(e){return ep.current.useRef(e)},q=function(e){return ep.current.useState(e)},D=function(e,t,s){return ep.current.useSyncExternalStore(e,t,s)},M=function(){return ep.current.useTransition()},O="18.3.1"});var l={};l=n("1b2ls");let{useState:o,useEffect:i,useRef:c,useMemo:d}=React,m=["Cairo","Amiri","Tajawal","Almarai","Lalezar","Scheherazade New","Lemonada","Reem Kufi","Changa","El Messiri","Mada","Harmattan","Lateef","Mirza","Rakkas","Katibeh","Aref Ruqaa","Vibes","Cairo Play","Readex Pro","Marhey","Alexandria","Kufam","Blaka","Gulzar","Noto Kufi Arabic","Noto Naskh Arabic","IBM Plex Sans Arabic","Rubik","Zain"],u=({name:e,className:t="",size:s=""})=>(0,l.jsx)("i",{className:`fas ${{BookOpen:"fa-book-open",Moon:"fa-moon",Star:"fa-star",Trophy:"fa-trophy",ArrowRight:"fa-arrow-right",Settings:"fa-cog",Gift:"fa-gift",CheckCircle:"fa-check-circle",XCircle:"fa-times-circle",Sparkles:"fa-magic",Loader2:"fa-spinner fa-spin",Info:"fa-info-circle",Plus:"fa-plus",Trash2:"fa-trash-alt",Edit3:"fa-pen",HelpCircle:"fa-question-circle",AlertTriangle:"fa-exclamation-triangle",X:"fa-times",Upload:"fa-upload",Palette:"fa-palette",Layout:"fa-layer-group",MessageSquare:"fa-comment-alt",ImageIcon:"fa-image",Grid:"fa-th-large",Monitor:"fa-desktop",CheckSquare:"fa-check-square",RotateCcw:"fa-undo",Download:"fa-download",UploadCloud:"fa-cloud-upload-alt",Save:"fa-save",Play:"fa-play",User:"fa-user-tie",Images:"fa-images",Mobile:"fa-mobile-alt",Maximize:"fa-expand",Minimize:"fa-compress",Medal:"fa-medal",Clock:"fa-clock",Gamepad:"fa-gamepad",Type:"fa-font",Lock:"fa-lock",Key:"fa-key",Unlock:"fa-unlock",Power:"fa-power-off",Refresh:"fa-sync-alt",Home:"fa-home"}[e]||"fa-circle"} ${t}`,style:{fontSize:s?s+"px":"inherit"}}),x={mainMenu:"الرئيسية",controlPanel:"الإعدادات",appTitle:"المسابقة الكبرى",appSubtitle:"العلم نور",chooseCategory:"اختر المجال",questionsRemaining:"سؤال",backToSections:"رجوع",generateAI:"توليد (AI)",generating:"جاري التحضير...",answered:"مجاب",clickToOpen:"فتح",sectionCompleted:"أحسنت!",correctTitle:"إجابة صحيحة",correctMessage:"زادك الله علمًا وتوفيقًا.",wrongTitle:"إجابة خاطئة",wrongMessage:"لا بأس، حاول مرة أخرى.",goToPrizes:"استلام الجائزة",backToQuestions:"عودة",explainAI:"تفسير (AI)",knowAnswerAI:"كشف الجواب (AI)",choosePrize:"اختر الهدية",prizeTaken:"تم",congrats:"مبارك!",youWon:"حصلت على",continue:"استمرار",dangerZone:"منطقة الخطر",resetTitle:"تصفير",resetDesc:"إعادة تعيين جميع البيانات والنتائج. هل أنت متأكد؟",confirmReset:"تأكيد",alertTitle:"تنبيه",confirmYes:"نعم",confirmNo:"لا",dataManagement:"البيانات",exportData:"تصدير",importData:"استيراد",autoSaveInfo:"حفظ تلقائي",sponsoredBy:"برعاية",startQuiz:"ابدأ المسابقة",rotateDevice:"يرجى تدوير الجهاز",time:"الوقت",enterPin:"أدخل رمز المرور",incorrectPin:"رمز خاطئ",changePin:"تغيير الرمز",newPin:"الرمز الجديد",pinUpdated:"تم تحديث الرمز",homeScreen:"شاشة البداية"},p={sections:[{id:1,title:"القرآن الكريم",icon:"BookOpen",color:"#1b4332"},{id:2,title:"السيرة النبوية",icon:"Moon",color:"#1e40af"},{id:3,title:"الفقه والعقيدة",icon:"Star",color:"#b45309"}],questions:[{id:101,sectionId:1,text:"كم عدد سور القرآن الكريم؟",type:"choice",options:["110","114","120","99"],answer:"114",isAnswered:!1},{id:102,sectionId:1,text:"ما هي أعظم سورة في القرآن الكريم؟",type:"choice",options:["سورة البقرة","سورة الكهف","سورة الفاتحة","سورة الإخلاص"],answer:"سورة الفاتحة",isAnswered:!1}],prizes:[{id:1,name:"عطر فاخر",image:"https://cdn-icons-png.flaticon.com/512/2829/2829929.png",isTaken:!1},{id:2,name:"مسبحة إلكترونية",image:"https://cdn-icons-png.flaticon.com/512/4393/4393963.png",isTaken:!1},{id:3,name:"مصحف مذهب",image:"https://cdn-icons-png.flaticon.com/512/3023/3023573.png",isTaken:!1},{id:4,name:"بطاقة شراء",image:"https://cdn-icons-png.flaticon.com/512/10530/10530869.png",isTaken:!1}]},f=({config:e})=>{let t={position:"fixed",inset:0,zIndex:0,pointerEvents:"none",backgroundColor:"var(--theme-bg)"};return"image"===e.bgMode&&e.customBgImage?(t.backgroundImage=`url("${e.customBgImage}")`,t.backgroundSize="cover",t.backgroundPosition="center"):t.backgroundImage="url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23000000' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")",(0,l.jsx)("div",{style:t,children:e.baseTransparent&&(0,l.jsx)("div",{className:"absolute inset-0 bg-white/70 backdrop-blur-[1px]"})})},h=({labels:e})=>(0,l.jsxs)("div",{id:"portrait-warning",className:"fixed inset-0 z-[200] bg-classic-dark flex flex-col items-center justify-center text-white p-8 text-center animate-fade-in border-4 border-classic-gold m-4 rounded-xl",children:[(0,l.jsx)(u,{name:"Mobile",size:"48",className:"text-classic-gold mb-4 animate-bounce"}),(0,l.jsx)("h2",{className:"text-3xl font-bold mb-4 text-classic-gold font-amiri",children:e.rotateDevice})]}),b=({isOpen:e,onClose:t,onSuccess:s,labels:a})=>{let[n,r]=o(""),[d,m]=o(!1),[x,p]=o(!1),f=c(null);i(()=>{e&&(r(""),m(!1),p(!1),setTimeout(()=>f.current?.focus(),100))},[e]);let h=async e=>{if(e.preventDefault(),x)return;p(!0);let a=!1;try{window.api&&window.api.checkAdminPassword?a=await window.api.checkAdminPassword(n):console.error("API checkAdminPassword not available")}catch(e){console.error(e)}p(!1),a?(s(),t()):(m(!0),r(""),setTimeout(()=>m(!1),2e3))};return e?(0,l.jsx)("div",{className:"fixed inset-0 z-[160] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",children:(0,l.jsx)("div",{className:"bg-white rounded-xl p-8 max-w-sm w-full shadow-2xl border-t-8 border-classic-dark animate-fade-in",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-classic-bg rounded-full flex items-center justify-center mx-auto mb-4 border-2 border-classic-gold",children:(0,l.jsx)(u,{name:d?"XCircle":"Lock",size:"32",className:d?"text-red-500":"text-classic-dark"})}),(0,l.jsx)("h3",{className:"text-xl font-bold text-classic-dark mb-6 font-amiri",children:a.enterPin}),(0,l.jsxs)("form",{onSubmit:h,children:[(0,l.jsx)("input",{ref:f,type:"password",value:n,onChange:e=>r(e.target.value),maxLength:"20",disabled:x,className:`w-full p-4 border-2 rounded-lg text-center text-2xl font-bold tracking-widest mb-4 outline-none transition ${d?"border-red-500 bg-red-50":"border-classic-gold focus:border-classic-dark"} ${x?"opacity-50 cursor-not-allowed":""}`,placeholder:"••••"}),d&&(0,l.jsx)("p",{className:"text-red-500 text-sm font-bold mb-4 animate-pulse",children:a.incorrectPin}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{type:"button",onClick:t,disabled:x,className:"flex-1 py-3 rounded bg-gray-200 text-gray-700 font-bold hover:bg-gray-300 transition disabled:opacity-50",children:a.confirmNo}),(0,l.jsx)("button",{type:"submit",disabled:x,className:"flex-1 py-3 rounded bg-classic-dark text-white font-bold hover:bg-classic-green transition disabled:opacity-50 display-flex items-center justify-center gap-2",children:x?(0,l.jsx)(u,{name:"Loader2"}):a.confirmReset})]})]})]})})}):null},g=({appConfig:e,setAppConfig:t,data:s,setData:a,onClose:n,onReset:r,apiKey:i})=>{let[d,x]=o("general"),[p,f]=o(null),[h,b]=o({title:"",color:"#1b4332"}),[g,y]=o({sectionId:"",text:"",type:"choice",op1:"",op2:"",op3:"",op4:"",answer:""}),[j,w]=o({name:""}),[v,N]=o(""),[k,C]=o({name:""}),S=c(null),I=c(null),T=(e,s)=>{let a=s.target.files[0];if(a){let s=new FileReader;s.onloadend=()=>{t(t=>"customBgImage"===e?{...t,bgMode:"image",customBgImage:s.result}:{...t,layoutImages:{...t.layoutImages,[e]:s.result}})},s.readAsDataURL(a)}},z=async e=>{e.preventDefault();let{text:t,type:s,op1:n,op2:r,op3:l,op4:o,answer:i,sectionId:c}=g;if(!c||!i)return alert("البيانات ناقصة");let d={text:t,type:s,options:"boolean"===s?["صح","خطأ"]:[n,r,l,o],answer:i,sectionId:parseInt(c)};if(window.api&&window.api.addQuestion)try{p?await window.api.updateQuestion(p,d):await window.api.addQuestion({...d,isAnswered:!1})}catch(e){console.error("Error saving to Firestore:",e),alert("حدث خطأ أثناء الحفظ في قاعدة البيانات")}else{let e={...d,id:Date.now(),isAnswered:!1};p?a(e=>({...e,questions:e.questions.map(e=>e.id===p?{...e,...d}:e)})):a(t=>({...t,questions:[...t.questions,e]}))}f(null),y({sectionId:"",text:"",type:"choice",op1:"",op2:"",op3:"",op4:"",answer:""})},_=async()=>{if(v.length>=4)try{window.api&&window.api.changeAdminPassword?await window.api.changeAdminPassword(v)?(t(e=>({...e,adminPin:v})),N(""),alert(e.labels.pinUpdated||"تم تحديث الرمز")):alert("حدث خطأ أثناء تحديث الرمز في قاعدة البيانات"):(t(e=>({...e,adminPin:v})),N(""),alert(e.labels.pinUpdated||"تم تحديث الرمز (محلياً فقط)"))}catch(e){console.error("Error in handleChangePin:",e),alert("حدث خطأ غير متوقع")}else alert("الرمز يجب أن يكون 4 أرقام على الأقل")};return(0,l.jsx)("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 text-slate-800 font-cairo",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-5xl h-[85vh] flex overflow-hidden shadow-2xl border-4 border-classic-gold",children:[(0,l.jsxs)("div",{className:"w-64 bg-classic-dark text-white p-4 flex flex-col gap-2 overflow-y-auto",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold text-classic-gold mb-4 flex items-center gap-2",children:[(0,l.jsx)(u,{name:"Settings"})," الإعدادات"]}),["general","gameplay","security","intro","home_images","sections","questions","prizes","texts","data"].map(e=>(0,l.jsx)("button",{onClick:()=>x(e),className:`p-3 rounded text-right font-bold transition ${d===e?"bg-classic-gold text-classic-dark":"hover:bg-white/10"}`,children:"general"===e?"المظهر والألوان":"gameplay"===e?"اللعب":"security"===e?"الأمان":"intro"===e?"البداية والرعاة":"sections"===e?"الأقسام":"questions"===e?"الأسئلة":"prizes"===e?"الجوائز":"home_images"===e?"الصور":"texts"===e?"النصوص":"البيانات"},e)),(0,l.jsx)("button",{onClick:n,className:"mt-auto p-3 rounded border border-red-400 text-red-300 hover:bg-red-900/20 font-bold",children:"إغلاق"})]}),(0,l.jsxs)("div",{className:"flex-1 bg-gray-50 p-6 overflow-y-auto",children:["general"===d&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"classic-card p-6",children:[(0,l.jsxs)("h3",{className:"font-bold mb-4 text-classic-dark flex items-center gap-2",children:[(0,l.jsx)(u,{name:"Palette"})," تخصيص الألوان"]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-bold mb-1",children:"اللون الأساسي"}),(0,l.jsx)("input",{type:"color",value:e.themeColors?.primary||"#1b4332",onChange:e=>t(t=>({...t,themeColors:{...t.themeColors||{},primary:e.target.value}})),className:"w-full h-10 cursor-pointer"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-bold mb-1",children:"اللون الثانوي (الذهبي)"}),(0,l.jsx)("input",{type:"color",value:e.themeColors?.secondary||"#d4af37",onChange:e=>t(t=>({...t,themeColors:{...t.themeColors||{},secondary:e.target.value}})),className:"w-full h-10 cursor-pointer"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-bold mb-1",children:"لون الخلفية"}),(0,l.jsx)("input",{type:"color",value:e.themeColors?.bg||"#fdfbf7",onChange:e=>t(t=>({...t,themeColors:{...t.themeColors||{},bg:e.target.value}})),className:"w-full h-10 cursor-pointer"})]})]})]}),(0,l.jsxs)("div",{className:"classic-card p-6",children:[(0,l.jsxs)("h3",{className:"font-bold mb-4 text-classic-dark flex items-center gap-2",children:[(0,l.jsx)(u,{name:"Type"})," الخطوط (30 خط)"]}),(0,l.jsx)("select",{value:e.fontFamily||"Cairo",onChange:e=>t(t=>({...t,fontFamily:e.target.value})),className:"w-full p-2 border rounded font-bold",style:{fontFamily:e.fontFamily},children:m.map(e=>(0,l.jsx)("option",{value:e,style:{fontFamily:e},children:e},e))})]}),(0,l.jsxs)("div",{className:"classic-card p-6",children:[(0,l.jsx)("h3",{className:"font-bold mb-4 text-classic-dark",children:"الخلفية"}),(0,l.jsx)("input",{type:"file",onChange:e=>T("customBgImage",e),className:"block w-full text-sm mb-2"}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"checkbox",checked:e.baseTransparent,onChange:e=>t(t=>({...t,baseTransparent:e.target.checked}))})," تعتيم الخلفية"]})]}),(0,l.jsxs)("div",{className:"classic-card p-6 flex justify-between",children:[(0,l.jsx)("span",{children:"عرض ملء الشاشة (16:9)"}),(0,l.jsx)("input",{type:"checkbox",checked:e.presentationMode,onChange:e=>t(t=>({...t,presentationMode:e.target.checked}))})]})]}),"security"===d&&(0,l.jsxs)("div",{className:"space-y-4 classic-card p-6",children:[(0,l.jsxs)("h3",{className:"font-bold mb-4 text-classic-dark flex items-center gap-2",children:[(0,l.jsx)(u,{name:"Lock"})," إعدادات الأمان"]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-bold mb-2",children:"تغيير رمز المرور (Admin PIN)"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{type:"text",value:v,onChange:e=>N(e.target.value),className:"p-2 border rounded flex-1",placeholder:"الرمز الجديد"}),(0,l.jsx)("button",{onClick:_,className:"btn-classic px-4 rounded",children:"حفظ"})]})]}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"الرمز الحالي يستخدم للدخول إلى لوحة التحكم وإعادة ضبط المصنع."})]}),"gameplay"===d&&(0,l.jsxs)("div",{className:"space-y-4 classic-card p-6",children:[(0,l.jsxs)("label",{className:"flex items-center gap-2 font-bold text-gray-700",children:[(0,l.jsx)("input",{type:"checkbox",checked:e.enableTimer,onChange:e=>t(t=>({...t,enableTimer:e.target.checked})),className:"w-5 h-5"}),"تفعيل المؤقت"]}),(0,l.jsxs)("label",{className:"flex items-center gap-2 font-bold text-gray-700",children:[(0,l.jsx)("input",{type:"checkbox",checked:e.enableTTS,onChange:e=>t(t=>({...t,enableTTS:e.target.checked})),className:"w-5 h-5"}),"قراءة السؤال (TTS)"]})]}),"sections"===d&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),p?a(e=>({...e,sections:e.sections.map(e=>e.id===p?{...e,title:h.title,color:h.color}:e)})):a(e=>({...e,sections:[...e.sections,{id:Date.now(),title:h.title,icon:"Star",color:h.color}]})),f(null),b({title:"",color:"#1b4332"})},className:"p-4 bg-white rounded border border-gray-300 flex gap-2",children:[(0,l.jsx)("input",{value:h.title,onChange:e=>b({...h,title:e.target.value}),placeholder:"اسم القسم",className:"flex-1 p-2 border rounded"}),(0,l.jsx)("input",{type:"color",value:h.color,onChange:e=>b({...h,color:e.target.value}),className:"h-10 w-10 p-0 border-0 cursor-pointer"}),(0,l.jsx)("button",{className:"btn-classic px-6 rounded font-bold",children:"حفظ"})]}),s.sections.map(e=>(0,l.jsxs)("div",{className:"p-3 bg-white border rounded flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"w-4 h-4 rounded-full",style:{backgroundColor:e.color}}),(0,l.jsx)("span",{className:"font-bold",children:e.title})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>{f(e.id),b({title:e.title,color:e.color})},className:"text-blue-600",children:(0,l.jsx)(u,{name:"Edit3"})}),(0,l.jsx)("button",{onClick:()=>{confirm("حذف؟")&&a(t=>({...t,sections:t.sections.filter(t=>t.id!==e.id)}))},className:"text-red-600",children:(0,l.jsx)(u,{name:"Trash2"})})]})]},e.id))]}),"questions"===d&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("form",{onSubmit:z,className:"p-4 bg-white rounded border border-gray-300 space-y-3",children:[(0,l.jsxs)("select",{value:g.sectionId,onChange:e=>y({...g,sectionId:e.target.value}),className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"",children:"اختر القسم..."}),s.sections.map(e=>(0,l.jsx)("option",{value:e.id,children:e.title},e.id))]}),(0,l.jsx)("textarea",{value:g.text,onChange:e=>y({...g,text:e.target.value}),placeholder:"نص السؤال",rows:"2",className:"w-full p-2 border rounded"}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsxs)("label",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"radio",name:"qt",checked:"choice"===g.type,onChange:()=>y({...g,type:"choice"})})," خيارات"]}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"radio",name:"qt",checked:"boolean"===g.type,onChange:()=>y({...g,type:"boolean"})})," صح/خطأ"]})]}),"choice"===g.type&&(0,l.jsx)("div",{className:"grid grid-cols-2 gap-2",children:["op1","op2","op3","op4"].map(e=>(0,l.jsx)("input",{value:g[e],onChange:t=>y({...g,[e]:t.target.value}),placeholder:`\u{627}\u{644}\u{62E}\u{64A}\u{627}\u{631} ${e.replace("op","")}`,className:"p-2 border rounded"},e))}),(0,l.jsxs)("select",{value:g.answer,onChange:e=>y({...g,answer:e.target.value}),className:"w-full p-2 border rounded font-bold bg-green-50 text-green-700",children:[(0,l.jsx)("option",{value:"",children:"الإجابة الصحيحة"}),"boolean"===g.type?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("option",{value:"صح",children:"صح"}),(0,l.jsx)("option",{value:"خطأ",children:"خطأ"})]}):["op1","op2","op3","op4"].map(e=>g[e]&&(0,l.jsx)("option",{value:g[e],children:g[e]},e))]}),(0,l.jsx)("button",{className:"btn-classic w-full py-2 rounded font-bold",children:"حفظ السؤال"})]}),(0,l.jsx)("div",{className:"max-h-60 overflow-y-auto space-y-2",children:s.questions.map(e=>(0,l.jsxs)("div",{className:"p-2 border rounded bg-white flex justify-between items-center text-sm",children:[(0,l.jsx)("span",{className:"truncate flex-1",children:e.text}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>{f(e.id),y({...e,op1:e.options[0],op2:e.options[1],op3:e.options[2],op4:e.options[3]})},className:"text-blue-500",children:(0,l.jsx)(u,{name:"Edit3"})}),(0,l.jsx)("button",{onClick:()=>{confirm("حذف السؤال؟")&&(window.api&&window.api.deleteQuestion?window.api.deleteQuestion(e.id):a(t=>({...t,questions:t.questions.filter(t=>t.id!==e.id)})))},className:"text-red-500",children:(0,l.jsx)(u,{name:"Trash2"})})]})]},e.id))})]}),"prizes"===d&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=I.current?.files[0],s=e=>{p?a(t=>({...t,prizes:t.prizes.map(t=>t.id===p?{...t,name:j.name,image:e||t.image}:t)})):a(t=>({...t,prizes:[...t.prizes,{id:Date.now(),name:j.name,image:e||"https://cdn-icons-png.flaticon.com/512/3023/3023573.png",isTaken:!1}]})),f(null),w({name:""})};if(t){let e=new FileReader;e.onloadend=()=>s(e.result),e.readAsDataURL(t)}else s(null)},className:"p-4 bg-white rounded border border-gray-300 flex gap-2 items-center",children:[(0,l.jsx)("input",{value:j.name,onChange:e=>w({...j,name:e.target.value}),placeholder:"اسم الجائزة",className:"flex-1 p-2 border rounded"}),(0,l.jsx)("input",{type:"file",ref:I,className:"text-sm w-40"}),(0,l.jsx)("button",{className:"btn-classic px-4 py-2 rounded font-bold",children:"إضافة"})]}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-2",children:s.prizes.map(e=>(0,l.jsxs)("div",{className:"p-2 border rounded bg-white flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("img",{src:e.image,className:"w-8 h-8 object-contain"}),(0,l.jsx)("span",{children:e.name})]}),(0,l.jsx)("button",{onClick:()=>a(t=>({...t,prizes:t.prizes.filter(t=>t.id!==e.id)})),className:"text-red-500",children:(0,l.jsx)(u,{name:"Trash2"})})]},e.id))})]}),"home_images"===d&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"classic-card p-4",children:[(0,l.jsx)("label",{className:"block font-bold mb-2",children:"تغيير حجم الشعارات الجانبية"}),(0,l.jsx)("input",{type:"range",min:"0.5",max:"1.5",step:"0.1",value:e.logoScale||1,onChange:e=>t(t=>({...t,logoScale:parseFloat(e.target.value)})),className:"w-full accent-classic-gold"})]}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:["topImage","bottomImage","rightImage","leftImage"].map(s=>(0,l.jsxs)("div",{className:"classic-card p-4",children:[(0,l.jsx)("label",{className:"block font-bold mb-2 text-sm",children:s.replace("Image","")}),(0,l.jsx)("input",{type:"file",onChange:e=>T(s,e),className:"text-sm w-full"}),e.layoutImages?.[s]&&(0,l.jsx)("button",{onClick:()=>{t(e=>{let t={...e.layoutImages};return delete t[s],{...e,layoutImages:t}})},className:"text-red-600 text-xs mt-2 font-bold",children:"حذف الصورة"})]},s))})]}),"intro"===d&&(0,l.jsxs)("div",{className:"space-y-4 classic-card p-6",children:[(0,l.jsxs)("label",{className:"flex items-center gap-2 font-bold mb-4",children:[(0,l.jsx)("input",{type:"checkbox",checked:e.enableIntro,onChange:e=>t(t=>({...t,enableIntro:e.target.checked}))})," تفعيل شاشة البداية"]}),(0,l.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,l.jsx)("h4",{className:"font-bold mb-2",children:"قائمة الرعاة (وسط الشاشة)"}),(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault();let s=S.current?.files[0];if(!s&&!k.name)return;let a=e=>{let s={id:Date.now(),name:k.name,logo:e};t(e=>({...e,sponsors:[...e.sponsors||[],s]})),C({name:""}),S.current&&(S.current.value="")};if(s){let e=new FileReader;e.onloadend=()=>a(e.result),e.readAsDataURL(s)}else a(null)},className:"flex gap-2 mb-4 bg-gray-50 p-2 rounded",children:[(0,l.jsx)("input",{value:k.name,onChange:e=>C({...k,name:e.target.value}),placeholder:"اسم الراعي",className:"flex-1 p-2 border rounded"}),(0,l.jsx)("input",{type:"file",ref:S,className:"text-sm w-48"}),(0,l.jsx)("button",{className:"btn-classic px-4 rounded",children:"إضافة"})]}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-2 max-h-40 overflow-y-auto",children:(e.sponsors||[]).map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-2 border rounded bg-white",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[e.logo&&(0,l.jsx)("img",{src:e.logo,className:"w-8 h-8 object-contain"}),(0,l.jsx)("span",{className:"text-sm font-bold",children:e.name})]}),(0,l.jsx)("button",{onClick:()=>{var s;return s=e.id,void t(e=>({...e,sponsors:(e.sponsors||[]).filter(e=>e.id!==s)}))},className:"text-red-500",children:(0,l.jsx)(u,{name:"X"})})]},e.id))})]}),(0,l.jsxs)("div",{className:"pt-2 border-t border-gray-200 mt-4",children:[(0,l.jsxs)("label",{className:"text-sm font-bold mb-2 flex justify-between",children:[(0,l.jsx)("span",{children:"حجم شعارات الرعاة"}),(0,l.jsxs)("span",{className:"text-gray-500 text-xs",children:[Math.round(100*(e.sponsorLogoScale||1)),"%"]})]}),(0,l.jsx)("input",{type:"range",min:"0.5",max:"3.0",step:"0.1",value:e.sponsorLogoScale||1,onChange:e=>t(t=>({...t,sponsorLogoScale:parseFloat(e.target.value)})),className:"w-full accent-classic-gold"})]})]}),"texts"===d&&(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(e.labels).map(([e,s])=>(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-xs font-bold text-gray-500 mb-1",children:e}),(0,l.jsx)("input",{value:s,onChange:s=>{let a;return a=s.target.value,t(t=>({...t,labels:{...t.labels,[e]:a}}))},className:"p-2 border rounded text-sm"})]},e))}),"data"===d&&(0,l.jsxs)("div",{className:"space-y-4 text-center",children:[(0,l.jsx)("button",{onClick:()=>{let t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify({appConfig:e,data:s,timestamp:new Date().toISOString()})),a=document.createElement("a");a.href=t,a.download="quiz_data.json",a.click()},className:"btn-outline w-full p-3 rounded font-bold",children:"تصدير البيانات (JSON)"}),(0,l.jsxs)("label",{className:"btn-outline w-full p-3 rounded font-bold block cursor-pointer",children:["استيراد بيانات",(0,l.jsx)("input",{type:"file",onChange:e=>{let s=e.target.files[0];if(s){let e=new FileReader;e.onload=e=>{try{let s=JSON.parse(e.target.result);s.data&&s.appConfig?window.confirm("تأكيد استبدال البيانات؟")&&(a(s.data),t(s.appConfig),alert("تم!")):alert("ملف غير صالح")}catch(e){alert("خطأ")}},e.readAsText(s)}},className:"hidden"})]})]})]})]})})},y=({status:e,progress:t,onDownload:s,onRestart:a,onClose:n,labels:r})=>e?(0,l.jsx)("div",{className:"fixed inset-0 z-[200] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-sm w-full shadow-2xl border-t-8 border-classic-gold animate-fade-in",children:[(0,l.jsxs)("div",{className:"text-center mb-6",children:[(0,l.jsxs)("div",{className:"w-16 h-16 mx-auto mb-4 bg-classic-bg rounded-full flex items-center justify-center border-2 border-classic-gold",children:["checking"===e&&(0,l.jsx)(u,{name:"Loader2",size:"32",className:"text-classic-dark"}),"available"===e&&(0,l.jsx)(u,{name:"Download",size:"32",className:"text-classic-dark"}),"no-update"===e&&(0,l.jsx)(u,{name:"CheckCircle",size:"32",className:"text-green-600"}),"downloading"===e&&(0,l.jsx)(u,{name:"Download",size:"32",className:"text-classic-dark animate-pulse"}),"ready"===e&&(0,l.jsx)(u,{name:"Gift",size:"32",className:"text-classic-gold"}),"error"===e&&(0,l.jsx)(u,{name:"AlertTriangle",size:"32",className:"text-red-500"})]}),(0,l.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:["checking"===e&&"جاري البحث عن تحديثات...","available"===e&&"يتوفر إصدار جديد!","no-update"===e&&"الإصدار الحالي هو الأحدث.","downloading"===e&&"جاري التنزيل...","ready"===e&&"التحديث جاهز للتثبيت!","error"===e&&"حدث خطأ أثناء التحديث"]}),(0,l.jsxs)("p",{className:"text-gray-600",children:["available"===e&&"هل ترغب في تنزيل التحديث الآن؟","downloading"===e&&(0,l.jsxs)("span",{className:"text-2xl font-bold text-classic-gold",children:[Math.round(t),"%"]}),"ready"===e&&"يجب إعادة تشغيل التطبيق لتثبيت التحديث.","error"===e&&"تأكد من اتصالك بالإنترنت وحاول مرة أخرى."]})]}),"downloading"===e&&(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-6 overflows-hidden",children:(0,l.jsx)("div",{className:"bg-classic-gold h-4 rounded-full transition-all duration-300",style:{width:`${t}%`}})}),(0,l.jsxs)("div",{className:"flex gap-3",children:["available"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{onClick:n,className:"flex-1 py-2 rounded bg-gray-200 hover:bg-gray-300 font-bold",children:r.confirmNo}),(0,l.jsx)("button",{onClick:s,className:"flex-1 py-2 rounded bg-classic-dark text-white hover:bg-classic-green font-bold",children:r.confirmYes})]}),"ready"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{onClick:n,className:"flex-1 py-2 rounded bg-gray-200 hover:bg-gray-300 font-bold",children:"لاحقاً"}),(0,l.jsx)("button",{onClick:a,className:"flex-1 py-2 rounded bg-classic-gold text-white hover:brightness-110 font-bold",children:"إعادة التشغيل"})]}),("no-update"===e||"error"===e)&&(0,l.jsx)("button",{onClick:n,className:"flex-1 py-2 rounded bg-classic-dark text-white hover:bg-classic-green font-bold",children:"إغلاق"})]})]})}):null,j=({message:e,onConfirm:t,onCancel:s,labels:a})=>(0,l.jsx)("div",{className:"fixed inset-0 z-[150] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-sm w-full shadow-2xl border-t-8 border-classic-gold",children:[(0,l.jsxs)("div",{className:"text-center mb-6",children:[(0,l.jsx)(u,{name:"AlertTriangle",size:"40",className:"text-classic-gold mb-3"}),(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:a.alertTitle}),(0,l.jsx)("p",{className:"text-gray-600 font-bold",children:e})]}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsx)("button",{onClick:s,className:"flex-1 py-2 rounded bg-gray-200 hover:bg-gray-300 font-bold",children:a.confirmNo}),(0,l.jsx)("button",{onClick:t,className:"flex-1 py-2 rounded bg-classic-dark text-white hover:bg-classic-green font-bold",children:a.confirmYes})]})]})});ReactDOM.createRoot(document.getElementById("root")).render((0,l.jsx)(()=>{let[e,t]=o(p),[s,a]=o({bgMode:"pattern",activePatternId:"geo1",customBgImage:null,baseTransparent:!0,presentationMode:!1,labels:x,enableIntro:!0,sponsors:[],layoutImages:{},enableTimer:!0,enableTTS:!1,adminPin:"1234",logoScale:1,sponsorLogoScale:1,themeColors:{primary:"#1b4332",secondary:"#d4af37",bg:"#fdfbf7"},fontFamily:"Cairo"}),[n,r]=o(!1),[c,d]=o("home"),[m,w]=o(!1),[v,N]=o(30),[k,C]=o(null),[S,I]=o(null),[T,z]=o(null),[_,A]=o(null),[R,E]=o(!1),[P,q]=o({show:!1,action:null}),[D,M]=o({show:!1,message:"",onConfirm:null}),[O,$]=o(1),[L,F]=o(null),[U,B]=o(!1),[H,V]=o(!1),[Q,J]=o(null),[G,K]=o(0);i(()=>{window.api&&(window.api.onUpdateMessage?.(e=>J(e.status)),window.api.onUpdateAvailable?.(e=>J("available")),window.api.onUpdateNotAvailable?.(e=>J("no-update")),window.api.onDownloadProgress?.(e=>{J("downloading"),K(e)}),window.api.onUpdateDownloaded?.(e=>J("ready")),window.api.onUpdateError?.(e=>{console.error("Update error:",e),J("error")}))},[]),i(()=>{s.enableIntro&&!n&&d("intro")},[s.enableIntro]),i(()=>{let e=localStorage.getItem("qDataClassic"),s=localStorage.getItem("qConfigClassic");e&&t(JSON.parse(e)),s&&a(JSON.parse(s))},[]),i(()=>{window.api&&window.api.getQuestions?(window.api.getQuestions().then(e=>{console.log("Loaded questions from Firestore:",e),e&&e.length>0&&t(t=>({...t,questions:e}))}).catch(e=>console.error("Failed to load questions:",e)),window.api.onQuestionsUpdate(e=>{console.log("Realtime update:",e),t(t=>({...t,questions:e}))})):console.error("Window API is not defined. Preload script might have failed.")},[]),i(()=>{localStorage.setItem("qDataClassic",JSON.stringify(e))},[e]),i(()=>{localStorage.setItem("qConfigClassic",JSON.stringify(s))},[s]),i(()=>{let e=document.documentElement,t=s.themeColors?.primary||"#1b4332",a=s.themeColors?.secondary||"#d4af37",n=s.themeColors?.bg||"#fdfbf7",r=s.fontFamily||"Cairo";e.style.setProperty("--theme-primary",t),e.style.setProperty("--theme-secondary",a),e.style.setProperty("--theme-bg",n),e.style.setProperty("--theme-font",r),e.style.setProperty("--theme-primary-light",t)},[s.themeColors,s.fontFamily]),i(()=>{if(!s.presentationMode)return void $(1);let e=()=>$(Math.min(window.innerWidth/1920,window.innerHeight/1080));return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[s.presentationMode]),i(()=>{let e=()=>w(!!document.fullscreenElement);return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]),i(()=>{let e;return"question"===c&&!_&&s.enableTimer&&v>0&&(e=setInterval(()=>N(e=>e-1),1e3)),()=>clearInterval(e)},[v,c,_,s.enableTimer]);let W=(e=!1)=>{let t=window.confetti;if("function"!=typeof t)return;let a=[s.themeColors?.primary||"#1b4332",s.themeColors?.secondary||"#d4af37","#ffffff"];if(e){let e=Date.now()+3e3;!function s(){t({particleCount:6,angle:60,spread:55,origin:{x:0},colors:a}),t({particleCount:6,angle:120,spread:55,origin:{x:1},colors:a}),Date.now()<e&&requestAnimationFrame(s)}()}else t({particleCount:100,spread:80,origin:{y:.7},colors:a})},X=()=>{t(e=>({...e,questions:e.questions.map(e=>({...e,isAnswered:!1})),prizes:e.prizes.map(e=>({...e,isTaken:!1}))})),alert("تم تصفير البيانات بنجاح")},Y=async(e,s)=>{V(!0);try{let a=`Generate 5 multiple choice questions in Arabic about "${e}". JSON format: [{"text":"?","options":["a","b","c","d"],"answer":"a","type":"choice"}]`,n=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:a}]}]})}),r=await n.json(),l=r.candidates?.[0]?.content?.parts?.[0]?.text;if(!l)throw Error("No data");let o=l.replace(/```json/g,"").replace(/```/g,"").trim(),i=JSON.parse(o).map((e,t)=>({...e,id:Date.now()+t,sectionId:s,isAnswered:!1}));t(e=>({...e,questions:[...e.questions,...i]})),alert("تمت الإضافة بنجاح!")}catch(e){console.error(e),alert("حدث خطأ أثناء التوليد.")}finally{V(!1)}},Z=async(e,t)=>{B(!0),F(null);try{let s=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:`\u{627}\u{634}\u{631}\u{62D} \u{644}\u{645}\u{627}\u{630}\u{627} "${t}" \u{647}\u{64A} \u{625}\u{62C}\u{627}\u{628}\u{629} "${e}" \u{628}\u{627}\u{62E}\u{62A}\u{635}\u{627}\u{631}.`}]}]})}),a=await s.json();F(a.candidates?.[0]?.content?.parts?.[0]?.text)}catch{F("عذراً، الخدمة غير متاحة.")}finally{B(!1)}},ee=(0,l.jsxs)("div",{className:"h-full w-full relative flex flex-col font-cairo select-none",dir:"rtl",children:[(0,l.jsx)(h,{labels:s.labels}),(0,l.jsxs)("header",{className:"absolute top-0 w-full p-4 z-30 flex justify-between items-center pointer-events-none bg-white/90 border-b border-gray-200 shadow-sm transition-colors",children:[(0,l.jsx)("div",{className:"pointer-events-auto flex gap-2",children:"intro"!==c&&(0,l.jsxs)("div",{className:"flex items-center gap-2 px-2",children:[(0,l.jsx)(u,{name:"Moon",className:"text-classic-dark"}),(0,l.jsx)("span",{className:"font-bold text-gray-700",children:s.labels.appTitle})]})}),(0,l.jsxs)("div",{className:"flex gap-2 pointer-events-auto",children:["home"===c&&(0,l.jsx)("button",{onClick:()=>M({show:!0,message:s.labels.resetDesc,onConfirm:()=>{X(),M({show:!1,message:"",onConfirm:null})}}),className:"bg-red-50 text-red-600 border border-red-200 hover:bg-red-600 hover:text-white transition w-9 h-9 rounded flex items-center justify-center",title:s.labels.resetTitle,children:(0,l.jsx)(u,{name:"Trash2"})}),"intro"!==c&&(0,l.jsx)("button",{onClick:()=>d("intro"),className:"btn-outline w-9 h-9 rounded flex items-center justify-center bg-gray-100",title:s.labels.homeScreen,children:(0,l.jsx)(u,{name:"Home"})}),"home"!==c&&"intro"!==c&&(0,l.jsxs)("button",{onClick:()=>d("home"),className:"btn-outline px-4 py-1 rounded font-bold text-sm",children:[(0,l.jsx)(u,{name:"Grid"})," ",s.labels.mainMenu]}),(0,l.jsx)("button",{onClick:()=>{document.fullscreenElement?document.exitFullscreen().then(()=>w(!1)).catch(console.log):document.documentElement.requestFullscreen().then(()=>w(!0)).catch(console.log)},className:"btn-outline w-9 h-9 rounded flex items-center justify-center",title:"ملء الشاشة",children:(0,l.jsx)(u,{name:m?"Minimize":"Maximize"})}),(0,l.jsx)("button",{onClick:()=>{q({show:!0,action:"settings"})},className:"btn-outline w-9 h-9 rounded flex items-center justify-center",children:(0,l.jsx)(u,{name:"Settings"})})]})]}),(0,l.jsxs)("main",{className:"flex-1 relative z-10 flex items-center justify-center overflow-hidden pt-16",children:["intro"===c&&(0,l.jsx)(()=>(0,l.jsx)("div",{className:"flex flex-col items-center justify-center h-full w-full animate-fade-in relative z-10 p-12 text-center",children:(0,l.jsxs)("div",{className:"classic-card p-12 bg-white max-w-5xl w-full flex flex-col items-center shadow-2xl relative overflow-hidden",children:[(0,l.jsx)("h1",{className:"text-7xl font-bold text-classic-dark mb-4 font-amiri border-b-2 border-classic-gold pb-4 px-8 mt-4",children:s.labels.appTitle}),(0,l.jsx)("p",{className:"text-2xl text-gray-600 font-bold mb-10",children:s.labels.appSubtitle}),s.sponsors&&s.sponsors.length>0&&(0,l.jsxs)("div",{className:"mb-10 w-full",children:[(0,l.jsx)("div",{className:"text-gray-500 font-bold mb-4 text-sm uppercase tracking-widest",children:s.labels.sponsoredBy}),(0,l.jsx)("div",{className:"flex flex-wrap items-center justify-center gap-8",children:s.sponsors.map(e=>(0,l.jsxs)("div",{className:"flex flex-col items-center gap-2 transition-transform hover:scale-110",children:[e.logo&&(0,l.jsx)("img",{src:e.logo,className:"object-contain drop-shadow-md",style:{height:`${6*(s.sponsorLogoScale||1)}rem`},alt:e.name}),e.name&&(0,l.jsx)("span",{className:"text-classic-dark font-bold text-lg",children:e.name})]},e.id))})]}),(0,l.jsx)("button",{onClick:()=>{r(!0),d("home")},className:"btn-classic text-2xl font-bold py-4 px-16 rounded-full shadow-lg mt-auto",children:s.labels.startQuiz})]})}),{}),"home"===c&&(0,l.jsxs)("div",{className:"w-full h-full flex flex-col relative animate-fade-in",children:[s.layoutImages?.topImage&&(0,l.jsx)("img",{src:s.layoutImages.topImage,className:"absolute top-0 w-full h-24 object-contain object-top opacity-100 pointer-events-none z-0"}),s.layoutImages?.bottomImage&&(0,l.jsx)("img",{src:s.layoutImages.bottomImage,className:"absolute bottom-0 w-full h-24 object-contain object-bottom opacity-100 pointer-events-none z-0"}),(0,l.jsxs)("div",{className:"flex-1 flex w-full h-full items-center justify-center relative z-10 p-8 gap-8",children:[s.layoutImages?.rightImage&&(0,l.jsx)("img",{src:s.layoutImages.rightImage,className:"h-2/3 w-32 object-contain opacity-100 pointer-events-none hidden lg:block z-20",style:{transform:`scale(${s.logoScale||1})`}}),s.layoutImages?.leftImage&&(0,l.jsx)("img",{src:s.layoutImages.leftImage,className:"h-2/3 w-32 object-contain opacity-100 pointer-events-none hidden lg:block z-20",style:{transform:`scale(${s.logoScale||1})`}}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 w-full max-w-6xl",children:e.sections.map((t,a)=>(0,l.jsxs)("button",{onClick:()=>{C(t),d("section")},className:"classic-card group h-80 p-6 flex flex-col justify-between text-right hover:border-classic-gold transition-all duration-200 hover:-translate-y-1",children:[(0,l.jsx)("div",{className:"w-20 h-20 rounded-full flex items-center justify-center text-4xl shadow-md text-white mb-4 border-4 border-white",style:{background:t.color},children:(0,l.jsx)(u,{name:t.icon})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-3xl font-bold text-gray-800 mb-2 font-amiri",children:t.title}),(0,l.jsxs)("div",{className:"inline-flex items-center gap-2 bg-gray-100 px-3 py-1 rounded border border-gray-200",children:[(0,l.jsx)("span",{className:"w-2 h-2 rounded-full bg-classic-dark"}),(0,l.jsxs)("span",{className:"text-gray-600 font-bold text-sm",children:[e.questions.filter(e=>e.sectionId===t.id&&!e.isAnswered).length," ",s.labels.questionsRemaining]})]})]}),(0,l.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 group-hover:bg-classic-dark group-hover:text-white transition-colors self-end",children:(0,l.jsx)(u,{name:"ArrowRight",size:"16"})})]},t.id))})]})]}),"section"===c&&k&&(0,l.jsxs)("div",{className:"w-full max-w-7xl animate-in zoom-in-95 p-8 h-full flex flex-col",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-8 bg-white p-4 rounded-lg border-2 border-gray-200 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("button",{onClick:()=>d("home"),className:"btn-outline w-12 h-12 rounded-full flex items-center justify-center text-xl hover:bg-slate-100 transition shadow-sm",title:s.labels.backToSections,children:(0,l.jsx)(u,{name:"ArrowRight"})}),(0,l.jsx)("button",{onClick:()=>d("intro"),className:"btn-outline w-12 h-12 rounded-full flex items-center justify-center text-xl hover:bg-slate-100 transition shadow-sm",children:(0,l.jsx)(u,{name:"Home"})}),(0,l.jsx)("h2",{className:"text-4xl font-bold text-classic-dark font-amiri",children:k.title})]}),(0,l.jsxs)("button",{onClick:()=>Y(k.title,k.id),disabled:H,className:"btn-outline px-6 py-2 rounded flex items-center gap-2 font-bold",children:[H?(0,l.jsx)(u,{name:"Loader2"}):(0,l.jsx)(u,{name:"Sparkles",className:"text-purple-600"}),(0,l.jsx)("span",{children:s.labels.generateAI})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-5 md:grid-cols-6 lg:grid-cols-8 gap-6 flex-1 content-start overflow-y-auto custom-scrollbar p-2",children:e.questions.filter(e=>e.sectionId===k.id).map((e,t)=>(0,l.jsx)("button",{disabled:e.isAnswered,onClick:()=>{I(e),N(30),A(null),d("question"),(e=>{if(!s.enableTTS)return;window.speechSynthesis.cancel();let t=new SpeechSynthesisUtterance(e);t.lang="ar-SA",window.speechSynthesis.speak(t)})(e.text)},className:`aspect-square rounded-xl text-3xl font-bold flex items-center justify-center transition-all duration-200 shadow-sm border-2 ${e.isAnswered?"bg-gray-200 border-gray-300 text-gray-400":"bg-white border-gray-300 text-classic-dark hover:border-classic-gold hover:shadow-md"}`,children:e.isAnswered?(0,l.jsx)(u,{name:"CheckCircle"}):(0,l.jsx)("span",{className:"font-amiri",children:t+1})},e.id))})]}),"question"===c&&S&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:(0,l.jsxs)("div",{className:"bg-white w-full max-w-5xl rounded-2xl overflow-hidden shadow-2xl flex flex-col border-4 border-classic-gold h-[85vh]",children:[(0,l.jsxs)("div",{className:"p-10 bg-classic-dark text-white text-center relative border-b-4 border-classic-gold flex-[0.4] flex flex-col items-center justify-center",children:[(0,l.jsx)("h3",{className:"text-4xl font-bold font-amiri leading-relaxed max-w-4xl",children:S.text}),s.enableTimer&&!_&&(0,l.jsxs)("div",{className:`absolute top-6 right-6 text-2xl font-bold flex items-center gap-2 px-4 py-1 rounded bg-white/10 border ${v<10?"text-red-300 border-red-300 animate-pulse":"text-classic-gold border-classic-gold"}`,children:[(0,l.jsx)(u,{name:"Clock"})," ",v]}),(0,l.jsxs)("div",{className:"absolute top-6 left-6 flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>d("intro"),className:"w-10 h-10 rounded bg-white/10 hover:bg-white/20 flex items-center justify-center text-white border border-white/30",children:(0,l.jsx)(u,{name:"Home",size:"20"})}),(0,l.jsx)("button",{onClick:()=>d("section"),className:"w-10 h-10 rounded bg-white/10 hover:bg-white/20 flex items-center justify-center text-white border border-white/30",children:(0,l.jsx)(u,{name:"X",size:"24"})})]})]}),(0,l.jsx)("div",{className:"p-8 bg-gray-50 flex-1 flex flex-col justify-center relative",children:_?(0,l.jsxs)("div",{className:"text-center animate-fade-in flex flex-col items-center justify-center h-full",children:[(0,l.jsx)("div",{className:`w-24 h-24 rounded-full flex items-center justify-center text-5xl mb-4 border-4 shadow-lg ${"correct"===_?"bg-emerald-100 text-emerald-700 border-emerald-500":"bg-red-100 text-red-700 border-red-500"}`,children:(0,l.jsx)(u,{name:"correct"===_?"CheckCircle":"XCircle"})}),(0,l.jsx)("h2",{className:"text-4xl font-bold mb-2 font-amiri text-gray-800",children:"correct"===_?s.labels.correctTitle:s.labels.wrongTitle}),(0,l.jsx)("p",{className:"text-xl text-gray-600 mb-8 font-bold",children:"correct"===_?s.labels.correctMessage:s.labels.wrongMessage}),(0,l.jsx)("div",{className:"flex gap-4",children:"correct"===_?(0,l.jsxs)("button",{onClick:()=>d("prizes"),className:"btn-gold px-12 py-4 rounded font-bold text-xl shadow-lg flex items-center gap-3",children:[(0,l.jsx)(u,{name:"Gift"})," ",s.labels.goToPrizes]}):(0,l.jsx)("button",{onClick:()=>d("section"),className:"btn-outline px-12 py-4 rounded font-bold text-xl",children:s.labels.backToQuestions})}),(0,l.jsxs)("button",{onClick:()=>Z(S.text,S.answer),disabled:U,className:"mt-8 text-classic-dark hover:underline font-bold flex items-center gap-2 mx-auto",children:[U?(0,l.jsx)(u,{name:"Loader2"}):(0,l.jsx)(u,{name:"Info"})," ","correct"===_?s.labels.explainAI:s.labels.knowAnswerAI]}),L&&(0,l.jsx)("div",{className:"mt-4 p-4 bg-white border border-gray-300 rounded text-lg text-gray-700 shadow-sm max-w-2xl",children:L})]}):(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 h-full",children:S.options.map((e,s)=>(0,l.jsxs)("button",{onClick:()=>{t(e=>({...e,questions:e.questions.map(e=>e.id===S.id?{...e,isAnswered:!0}:e)})),e===S.answer?(A("correct"),W(!1)):A("wrong")},className:"group p-6 text-2xl font-bold rounded-xl border-2 border-gray-300 bg-white text-gray-700 hover:border-classic-dark hover:bg-emerald-50 hover:text-classic-dark transition-all shadow-sm flex items-center",children:[(0,l.jsx)("span",{className:"w-10 h-10 rounded bg-gray-100 border border-gray-300 flex items-center justify-center ml-4 text-sm font-bold group-hover:bg-classic-dark group-hover:text-white",children:["أ","ب","ج","د"][s]}),e]},s))})})]})}),"prizes"===c&&(0,l.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center p-8 animate-fade-in",children:[(0,l.jsx)("h2",{className:"text-6xl font-bold mb-12 text-classic-dark font-amiri border-b-4 border-classic-gold px-12 pb-2",children:s.labels.choosePrize}),(0,l.jsx)("div",{className:"grid grid-cols-4 gap-8 w-full max-w-6xl",children:e.prizes.map((a,n)=>(0,l.jsx)("button",{disabled:a.isTaken,onClick:()=>{var s;let n;return s=a.id,void(!(n=e.prizes.find(e=>e.id===s)).isTaken&&(z(n),t(e=>({...e,prizes:e.prizes.map(e=>e.id===s?{...e,isTaken:!0}:e)})),d("prizeReveal"),W(!0)))},className:`classic-card h-72 flex flex-col items-center justify-center transition-all duration-300 transform ${a.isTaken?"bg-gray-200 grayscale opacity-60 cursor-not-allowed":"hover:-translate-y-2 hover:shadow-xl hover:border-classic-gold"}`,children:a.isTaken?(0,l.jsx)(u,{name:"CheckCircle",size:"64",className:"text-gray-400"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"text-8xl text-classic-gold animate-bounce",style:{animationDuration:"3s"},children:(0,l.jsx)(u,{name:"Gift"})}),(0,l.jsx)("div",{className:"mt-6 text-classic-dark font-bold text-lg opacity-0 group-hover:opacity-100 transition",children:s.labels.clickToOpen})]})},a.id))})]}),"prizeReveal"===c&&T&&(0,l.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/95 p-4 animate-fade-in",children:(0,l.jsxs)("div",{className:"classic-card p-16 text-center bg-white relative max-w-3xl w-full",children:[(0,l.jsx)("div",{className:"relative mb-8",children:(0,l.jsx)("img",{src:T.image,className:"w-64 h-64 mx-auto object-contain drop-shadow-xl animate-float"})}),(0,l.jsx)("h2",{className:"text-6xl font-bold text-classic-gold mb-4 font-amiri",children:s.labels.congrats}),(0,l.jsx)("p",{className:"text-3xl text-gray-700 mb-8 font-bold",children:s.labels.youWon}),(0,l.jsx)("div",{className:"bg-classic-dark text-white px-12 py-4 rounded text-4xl font-bold mb-10 shadow-lg border-2 border-classic-gold font-amiri",children:T.name}),(0,l.jsx)("button",{onClick:()=>d("section"),className:"btn-gold px-16 py-4 rounded font-bold text-2xl shadow-lg",children:s.labels.continue})]})})]}),P.show&&(0,l.jsx)(b,{isOpen:P.show,onClose:()=>q({show:!1,action:null}),onSuccess:()=>{let e=P.action;q({show:!1,action:null}),"settings"===e?E(!0):"reset"===e&&M({show:!0,message:s.labels.resetDesc,onConfirm:()=>{X(),M({show:!1,message:"",onConfirm:null})}})},labels:s.labels,currentPin:s.adminPin}),R&&(0,l.jsx)(g,{appConfig:s,setAppConfig:a,data:e,setData:t,onClose:()=>E(!1),onReset:X,apiKey:""}),D.show&&(0,l.jsx)(j,{message:D.message,onConfirm:D.onConfirm,onCancel:()=>M({show:!1,message:"",onConfirm:null}),labels:s.labels}),Q&&(0,l.jsx)(y,{status:Q,progress:G,onDownload:()=>window.api?.downloadUpdate(),onRestart:()=>window.api?.quitAndInstall(),onClose:()=>J(null),labels:s.labels})]});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f,{config:s}),s.presentationMode?(0,l.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black",children:(0,l.jsx)("div",{style:{width:1920,height:1080,transform:`scale(${O})`},className:"relative overflow-hidden bg-white shadow-2xl border-4 border-gray-800",children:ee})}):ee]})},{}));
//# sourceMappingURL=final-competetion.8aa7167d.js.map
